<!DOCTYPE html>
<html>
<head>
  <title>Синхронизированное видео</title>
  <style>
    #video {
      width: 100%;
      max-width: 800px;
    }
  </style>
</head>
<body>
    <iframe id="video" controls
  src="https://drive.google.com/file/d/1USk0hzHRLiCMY_mqB9k2ovjjaGD8JkbB/preview"
  width="100%" 
  height="400"
  allow="autoplay"
  style="border: none;"
></iframe>

  <script src="/socket.io/socket.io.js"></script>
  <script>
    const video = document.getElementById("video");
    const socket = io("http://localhost:3000");

    // Инициализация при загрузке
    socket.on("sync", (state) => {
      video.currentTime = state.currentTime;
      state.isPlaying ? video.play() : video.pause();
    });

    // Обработка событий с сервера
    socket.on("play", (time) => {
      video.currentTime = time;
      video.play();
    });

    socket.on("pause", (time) => {
      video.currentTime = time;
      video.pause();
    });

    socket.on("seek", (time) => {
      video.currentTime = time;
    });

    // Отправка событий на сервер
    video.addEventListener("play", () => {
      socket.emit("play");
    });

    video.addEventListener("pause", () => {
      socket.emit("pause");
    });

    video.addEventListener("seeked", () => {
      socket.emit("seek", video.currentTime);
    });

    video.addEventListener("timeupdate", () => {
      socket.emit("timeupdate", video.currentTime);
    });
  </script>
</body>
</html>
